---
- hosts: solr2
  gather_facts: False
  user: root

  tasks:
  - name: Write the new ec2 instance host key to known hosts
    connection: local
    shell: "ssh-keyscan -H {{ inventory_hostname }} >> ~/.ssh/known_hosts"

  - name: Processcheck-kdevtmpfsi
    shell: "ps -ef|grep kdevtmpfsi"
    register: ps

  - name: Processcheck-kinsing
    shell: "ps -ef|grep kinsing"
    register: kinsing
    
  - name: tmp-check
    shell: "ls -l /tmp"
    register: tmp

  # - name: IP check
  #   become: yes
  #   shell: "ip addr show|grep inet |grep -v inet6|grep -v '127.0'"
  #   register: ip
  
  - name: Top 5 Process check
    shell: "ps aux | sort -nrk 3,3 | head -n 5"
    register: ps5

  - name: Cron check
    shell: "crontab -l"
    register: cron

  - name: Processcheck-kdevtmpfsi -  Show Details
    debug: 
      msg: "{{ ps.stdout_lines }}"

  - name: Processcheck-kinsing -  Show Details
    debug: 
      msg: "{{ kinsing.stdout_lines }}"
  
  - name: tmp -  Show Details
    debug: 
      msg: "{{ tmp.stdout_lines }}"
  # - name: IP check -  Show Details
  #   debug: 
  #     msg: "{{ ip.stdout_lines }}"

  - name: Top 5 Process check -  Show Details
    debug: 
      msg: "{{ ps5.stdout_lines }}"

  - name: Cron check -  Show Details
    debug: 
      msg: "{{ cron.stdout_lines }}"